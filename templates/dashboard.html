{% extends "base.html" %}
{% block content %}
<div class="container container-compact mt-5">
  <h3 class="mb-4">Welcome, {{ session.get('user_name') }}!</h3>

  {% if session.get('role') == 'Job Giver' %}
    <div class="mb-5 p-4 bg-light rounded shadow-sm">
      <h5 class="mb-3">Post a New Job</h5>
      <form action="{{ url_for('post_job') }}" method="post">
        <div class="row g-3">
          <div class="col-md-4"><input name="title" class="form-control" placeholder="Job Title" required></div>
          <div class="col-md-4"><input name="company" class="form-control" placeholder="Company" required></div>
          <div class="col-md-4"><input name="location" class="form-control" placeholder="Location" required></div>
        </div>
        <div class="mt-3"><textarea name="description" class="form-control" rows="4" placeholder="Job description" required></textarea></div>
        <div class="mt-2 text-end"><button class="btn btn-dark">Post Job</button></div>
      </form>
    </div>

    <div>
      <h5 class="mb-3">Your Posted Jobs</h5>
      {% if jobs %}
        <div class="row g-4">
          {% for job in jobs %}
            <div class="col-md-6 col-lg-4">
              <div class="card h-100 shadow-sm p-3">
                <h5 class="card-title">{{ job.title }}</h5>
                <p class="card-text"><strong>Company:</strong> {{ job.company }}</p>
                <p class="card-text"><strong>Location:</strong> {{ job.location }}</p>
                <p class="card-text">{{ job.description[:120] }}{% if job.description|length > 120 %}...{% endif %}</p>
                <small class="text-muted mb-2 d-block">Posted: {{ job.date_posted.strftime('%d %b %Y') }}</small>
                <a href="#" class="btn btn-outline-dark btn-sm mt-auto">View / Edit</a>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-muted">You have not posted any jobs yet.</p>
      {% endif %}
    </div>

  {% else %}
    <div>
      <h5 class="mb-3">Available Jobs</h5>
      {% if jobs %}
        <div class="row g-4">
          {% for job in jobs %}
            <div class="col-md-6 col-lg-4">
              <div class="card h-100 shadow-sm p-3">
                <h5 class="card-title">{{ job.title }}</h5>
                <p class="card-text"><strong>Company:</strong> {{ job.company }}</p>
                <p class="card-text"><strong>Location:</strong> {{ job.location }}</p>
                <p class="card-text">{{ job.description[:120] }}{% if job.description|length > 120 %}...{% endif %}</p>
                <small class="text-muted mb-2 d-block">Posted: {{ job.date_posted.strftime('%d %b %Y') }}</small>
                <a href="#" class="btn btn-success btn-sm mt-auto">Apply</a>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-muted">No jobs available yet.</p>
      {% endif %}
    </div>
  {% endif %}
</div>
{% endblock %}
